---
---

<section id="newsletter" class="bg-brand-500 dark:bg-surface-newsletter rounded-4xl p-10 md:p-14 text-center shadow-soft-lg">
  <h2 class="text-2xl md:text-3xl font-bold text-white dark:text-white mb-3">Don't miss the good ones</h2>
  <p class="text-brand-100 dark:text-slate-400 mb-8 max-w-md mx-auto text-base leading-relaxed">
    A weekly digest of new roles, community picks, and healthcare UX reads. That's it.
  </p>
  <form id="newsletter-form" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
    <input
      type="email"
      id="newsletter-email"
      placeholder="you@example.com"
      required
      class="flex-1 px-5 py-3.5 rounded-2xl text-slate-900 dark:text-slate-100 bg-white/90 dark:bg-slate-900/50 placeholder-slate-400 text-sm border border-white/20 dark:border-slate-700 shadow-soft focus:outline-none focus:ring-2 focus:ring-white/30"
    />
    <button
      type="submit"
      id="newsletter-btn"
      class="px-6 py-3.5 bg-white text-brand-600 dark:bg-brand-500 dark:text-white font-semibold text-sm rounded-2xl shrink-0 shadow-soft hover:bg-white/90 dark:hover:bg-brand-400 transition-colors"
    >
      Subscribe
    </button>
  </form>
  <p id="newsletter-success" class="hidden text-white/90 dark:text-slate-300 text-sm mt-4">âœ“ You're in! Check your email to confirm.</p>
  <p id="newsletter-error" class="hidden text-red-200 dark:text-red-400 text-sm mt-4"></p>
</section>

<script is:inline>
document.getElementById('newsletter-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  var btn = document.getElementById('newsletter-btn');
  var email = document.getElementById('newsletter-email').value;
  var success = document.getElementById('newsletter-success');
  var error = document.getElementById('newsletter-error');
  btn.disabled = true;
  btn.textContent = 'Subscribing...';
  error.classList.add('hidden');
  try {
    var res = await fetch('/api/subscribe', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email: email })
    });
    var data = await res.json();
    if (data.ok) {
      document.getElementById('newsletter-form').classList.add('hidden');
      success.classList.remove('hidden');
    } else {
      error.textContent = data.error || 'Something went wrong. Try again.';
      error.classList.remove('hidden');
      btn.disabled = false;
      btn.textContent = 'Subscribe';
    }
  } catch (err) {
    error.textContent = 'Network error. Please try again.';
    error.classList.remove('hidden');
    btn.disabled = false;
    btn.textContent = 'Subscribe';
  }
});
</script>
