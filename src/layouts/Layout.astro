---
interface Props {
  title: string;
  description?: string;
}

const { title, description = "Healthcare UX jobs, curated by the community. Open source and free forever." } = Astro.props;
const canonicalUrl = new URL(Astro.url.pathname, 'https://designwith.care');
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl.href} />
    <meta property="og:site_name" content="designwith.care" />
    <meta property="og:image" content="https://designwith.care/og-image.png" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content="https://designwith.care/og-image.png" />

    <link rel="canonical" href={canonicalUrl.href} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="alternate" type="application/rss+xml" title="designwith.care Jobs Feed" href="/rss.xml" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <title>{title}</title>
    <script is:inline>
      document.documentElement.classList.add('js-ready');
      const t = localStorage.getItem('theme');
      if (t === 'dark' || (!t && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      }
    </script>
  </head>
  <body class="bg-creme-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100 font-sans antialiased min-h-screen flex flex-col transition-colors">
    <slot />
  </body>
</html>

<style is:global>
  @tailwind base;
  @tailwind components;
  @tailwind utilities;

  /* Custom easing curves (stronger than defaults) */
  :root {
    --ease-out-quart: cubic-bezier(0.165, 0.84, 0.44, 1);
    --ease-out-cubic: cubic-bezier(0.215, 0.61, 0.355, 1);
  }

  /* Button press feedback */
  a[class*="rounded-full"][class*="bg-sapphire"],
  button[type="submit"] {
    transition: background-color 150ms ease, transform 100ms var(--ease-out-cubic);
  }
  a[class*="rounded-full"][class*="bg-sapphire"]:active,
  button[type="submit"]:active {
    transform: scale(0.97);
  }

  /* Stagger fade-in animations */
  /* fadeUp — for hero/decorative elements (has scale + translateY) */
  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(12px) scale(0.98);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* fadeIn — for functional UI (opacity + subtle translateY only, no scale) */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-up {
    opacity: 0;
    animation: fadeUp 0.25s var(--ease-out-quart) forwards;
    will-change: transform, opacity;
  }

  .animate-fade-in {
    opacity: 0;
    animation: fadeIn 0.2s var(--ease-out-cubic) forwards;
    will-change: opacity, transform;
  }

  .stagger-1 { animation-delay: 0ms; }
  .stagger-2 { animation-delay: 60ms; }
  .stagger-3 { animation-delay: 120ms; }
  .stagger-4 { animation-delay: 180ms; }
  .stagger-5 { animation-delay: 240ms; }
  .stagger-6 { animation-delay: 300ms; }

  /* Intersection observer reveal — hidden by default, JS adds .visible */
  .js-ready .reveal {
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.2s var(--ease-out-cubic), transform 0.2s var(--ease-out-cubic);
    will-change: transform, opacity;
  }
  .js-ready .reveal.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Accessibility: respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .animate-fade-up {
      animation: none;
      opacity: 1;
    }
    .js-ready .reveal {
      transition: none;
      opacity: 1;
      transform: none;
    }
  }
</style>

<script is:inline>
  // Intersection observer for scroll-triggered reveals (js-ready added in <head>)
  document.addEventListener('DOMContentLoaded', function() {
    var reveals = document.querySelectorAll('.reveal');
    if (!reveals.length) return;

    if (!('IntersectionObserver' in window)) {
      // Fallback: just show everything
      reveals.forEach(function(el) { el.classList.add('visible'); });
      return;
    }

    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          var el = entry.target;
          var delay = el.dataset.delay || '0';
          el.style.transitionDelay = delay + 'ms';
          el.classList.add('visible');
          observer.unobserve(el);
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

    reveals.forEach(function(el) { observer.observe(el); });
  });
</script>
